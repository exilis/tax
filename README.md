# 税務最適化プログラム

合同会社P&Iの税務・社会保険料を最適化し、総資産（手取り+内部留保の実質価値）を最大化するGoogle Apps Scriptプログラム。

## 概要

このプログラムは、以下を自動計算・最適化します：

- **林佑樹・土井郁子・Linh・配偶者専従者**の最適な給与配分
- **P&I合同会社**への事務委託費の最適額
- **退職金**による将来の払い出し戦略
- **企業型DC・中退共**による節税効果
- **ふるさと納税**の上限額

### 最適化目標

```
最大化: 総資産 = 全員の手取り + P&I税引後利益の実質価値 + DC・中退共の実質価値
```

## クイックスタート

1. Google Spreadsheetsで `optimizer.gs` を開く
2. メニュー: **税金最適化 → 初期設定**
3. "optimization"シートでパラメータを調整
4. メニュー: **税金最適化 → 最適化実行**
5. "最適化結果（従業員）""最適化結果（役員）"シートで結果を確認

## ドキュメント構成

### 📊 [TAX_COMPARISON.md](TAX_COMPARISON.md)
**税制比較の理論と戦略**

- 退職金 vs 配当 vs 役員報酬の総合実効税率比較
- 27.5%という退職金税率の数学的根拠
- 退職金額別の個人税実効税率表
- 租税回避スキームのリスク分析
- 推奨する合法的節税戦略

**対象読者**: 経営者・税務戦略の理解を深めたい方

### 📅 [OPERATIONS.md](OPERATIONS.md)
**毎月・毎年・退職時の実務フロー**

- 給与・報酬の支払いスケジュール
- 社会保険料・源泉税の納付タイミング
- 企業型DC・中退共の運用方法
- 年末調整・確定申告の手順
- 退職金支給の具体的手続き

**対象読者**: 経理担当者・実務担当者

### 💻 [CLAUDE.md](CLAUDE.md)
**開発者向け技術ドキュメント**

- コードアーキテクチャ
- 主要な関数とアルゴリズム
- 税率・控除額などの定数
- 最適化ロジックの詳細

**対象読者**: プログラム開発・保守担当者

## 主要な設定

### 対象者

| 名前 | 役割 | 給与形態 | 居住地 |
|------|------|---------|--------|
| 林佑樹 | 役員 | Veltra固定給990万円/年 + P&I役員報酬（変動） | 神戸市 |
| 土井郁子 | 役員または従業員 | P&I給与/報酬（変動） | 西宮市 |
| Linh | 従業員 | 兵庫県最低賃金（202,400円/月・固定） | 神戸市 |
| 配偶者専従者 | 専従者 | 96万円/年（固定） | 神戸市 |

### 退職金制度

| 制度 | 林佑樹 | 土井郁子 | Linh |
|------|--------|---------|------|
| **企業型DC** | 55,000円/月 | 55,000円/月 | 27,500円/月 |
| **中退共** | - | 役員は加入不可<br>従業員は30,000円/月 | 5,000円/月 |
| **小規模企業共済** | 0円（不使用） | - | - |

## 重要な税制ポイント

### 退職金の税制優遇

退職金は最も税効率が高い受取方法です：

```
【30年勤続の場合】
退職所得控除: 800万円 + 70万円 × 10年 = 1,500万円
課税所得: (退職金 - 1,500万円) × 1/2
実効税率: 0-15%（3,000万円程度まで）

【比較】
- 退職金: 総合実効税率 23-35%
- 配当: 総合実効税率 38.8%（固定）
- 役員報酬: 総合実効税率 70-80%（社保含む）
```

### 推奨戦略：夫婦分散

```
累積税引後利益: 2,500万円

林・土井で5:5分散:
- 林: 1,250万円 → 個人税 0円（控除内）
- 土井: 1,250万円 → 個人税 0円（控除内）

総合実効税率: 23.2%（法人税のみ）
```

## ⚠️ 重要な注意事項

### 絶対にやってはいけないこと

❌ **会社を5年ごとに解散・新設立して退職金控除を繰り返し利用**
- 税務否認リスク: 95%以上
- 追徴税額: 500-1,000万円
- 期待値: -855万円の損失

詳細は [TAX_COMPARISON.md](TAX_COMPARISON.md) の「租税回避スキームのリスク」を参照。

### 定期同額給与の制約

- 役員報酬の変更は事業年度開始から3ヶ月以内のみ
- 期中変更は損金不算入リスク
- 最適化は年1回のみ実行

## ファイル構成

```
tax/
├── README.md                   # このファイル
├── TAX_COMPARISON.md          # 税制比較・戦略分析
├── OPERATIONS.md              # 実務フロー
├── CLAUDE.md                  # 開発者向けドキュメント
├── optimizer.gs               # メインプログラム
└── .gitignore                 # Git除外設定
```

## 技術仕様

- **プラットフォーム**: Google Apps Script
- **言語**: JavaScript (Apps Script API)
- **最適化手法**: グリッドサーチ（~21,000組み合わせ/収益シナリオ）
- **収益シナリオ**: 21パターン（基準額 + 3億円刻み～+3億円、5億円刻み～+5億円、1億円刻み～+1億円）

## 計算される主要指標

### 個人別
- 手取り額
- 所得税・住民税・個人事業税
- 社会保険料（本人・会社負担）
- ふるさと納税上限額
- 標準報酬月額

### 法人
- 課税所得
- 法人税・地方税
- 税引後利益
- 実効税率

### 将来価値
- 退職金の実質価値（個人税考慮後）
- 企業型DC・中退共の実質価値（受取時税率10%想定）

## ライセンス

プライベートプロジェクト

## 作成者

林佑樹

## 更新履歴

- 2024-10-19: 社会保険料計算の修正（健康保険・厚生年金の上限分離）
- 2024-10-19: 退職金27.5%税率の数学的根拠を文書化
- 2024-10-19: 租税回避スキームのリスク分析を追加
- 2024-10-19: README.md作成、ドキュメント構成整理
